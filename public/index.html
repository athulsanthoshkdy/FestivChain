<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#32B8C6">
    <meta name="description" content="FestivChain - Smart Festive Shopping with Real-time Pricing">

    <title>üéâ FestivChain - Smart Festive Shopping</title>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-storage-compat.js"></script>


    <!-- Firebase Config (will be added by user) -->
    <script src="src/js/firebase/firebaseConfig.js"></script>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="src/css/animations.css">
    <link rel="stylesheet" href="src/css/themes.css">
    <link rel="stylesheet" href="src/css/landing.css">
    <link rel="stylesheet" href="src/css/carousel.css">
    <link rel="stylesheet" href="src/css/overrides.css">
</head>

<body>
    <div id="app">
        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading FestivChain...</p>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>

        <!-- Theme Background Effects -->
        <div id="themeBackground" class="theme-background"></div>

        <!-- Navbar -->
        <nav class="landing-navbar">
            <div class="nav-brand">üéâ FestivChain</div>
            <div class="nav-links">
                <!-- Links removed as per request -->
            </div>
            <div class="nav-auth-buttons">
                <button class="btn-nav btn-nav-customer" onclick="showScreen('customerAuth')">Customer
                    Login</button>
                <button class="btn-nav btn-nav-vendor" onclick="showScreen('vendorAuth')">Vendor Login</button>
            </div>
        </nav>

        <!-- Screen: Landing Page -->
        <section id="landingPage" class="screen active">

            <!-- Festival Scroll Journey -->

            <!-- Diwali: Stats (Customers, Vendors) -->
            <div class="festival-section festival-diwali">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Diwali<br>Festival of Lights</h1>
                    <p class="hero-subtitle">Illuminate your celebrations with exclusive deals on lights, sweets, and
                        decor.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Diwali
                        Collection</button>

                    <div class="embedded-content reveal">
                        <div class="stat-item-embedded">
                            <h3 class="counter" data-target="5000">0</h3>
                            <p>Happy Customers</p>
                        </div>
                        <div class="stat-item-embedded">
                            <h3 class="counter" data-target="120">0</h3>
                            <p>Verified Vendors</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Christmas: Stats (Orders, Rating) -->
            <div class="festival-section festival-christmas">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Christmas<br>Season of Joy</h1>
                    <p class="hero-subtitle">Deck the halls with our curated Christmas collection. Gifts, trees, and
                        more.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Christmas
                        Collection</button>

                    <div class="embedded-content reveal">
                        <div class="stat-item-embedded">
                            <h3 class="counter" data-target="15000">0</h3>
                            <p>Orders Delivered</p>
                        </div>
                        <div class="stat-item-embedded">
                            <h3>4.8/5</h3>
                            <p>Average Rating</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vishu: Feature (Price Locking) -->
            <div class="festival-section festival-vishu">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Vishu<br>New Beginnings</h1>
                    <p class="hero-subtitle">Celebrate the harvest and new year with fresh produce and traditional Kani
                        items.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Vishu
                        Collection</button>

                    <div class="embedded-feature reveal">
                        <div class="feature-icon-small">üîí</div>
                        <h3>Price Locking</h3>
                        <p>Beat the festival price surge! Pre-book your items weeks in advance.</p>
                    </div>
                </div>
            </div>

            <!-- Pongal: Feature (Direct from Source) -->
            <div class="festival-section festival-pongal">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Pongal<br>Harvest of Prosperity</h1>
                    <p class="hero-subtitle">Honor the sun and the harvest with authentic Pongal essentials directly
                        from farmers.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Pongal
                        Collection</button>

                    <div class="embedded-feature reveal">
                        <div class="feature-icon-small">üöú</div>
                        <h3>Direct from Source</h3>
                        <p>We connect you directly with local farmers and vendors, ensuring freshness.</p>
                    </div>
                </div>
            </div>

            <!-- Eid: Feature (Smart Pooling) -->
            <div class="festival-section festival-eid">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Eid<br>Celebration of Unity</h1>
                    <p class="hero-subtitle">Share the joy with premium dates, dry fruits, and festive attire.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Eid
                        Collection</button>

                    <div class="embedded-feature reveal">
                        <div class="feature-icon-small">‚ö°</div>
                        <h3>Smart Pooling</h3>
                        <p>Join community buying pools to unlock bulk discounts.</p>
                    </div>
                </div>
            </div>

            <!-- Onam: Mission -->
            <div class="festival-section festival-onam">
                <div class="festival-overlay"></div>
                <div class="hero-content reveal">
                    <h1 class="hero-title">Onam<br>Colors of Tradition</h1>
                    <p class="hero-subtitle">Welcome King Mahabali with the freshest flowers for your Pookalam and Sadya
                        kits.</p>
                    <button class="btn btn-hero btn-hero-primary" onclick="showScreen('customerAuth')">Shop Onam
                        Collection</button>

                    <div class="embedded-mission reveal">
                        <h3>Our Mission</h3>
                        <p>To make festival shopping affordable and stress-free by eliminating middlemen.</p>
                        <button class="btn btn-hero btn-hero-secondary" onclick="showScreen('customerAuth')">Join the
                            Revolution</button>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="landing-footer">
                <div class="footer-content">
                    <div class="footer-col">
                        <h4>FestivChain</h4>
                        <p>Smart Festive Shopping Platform.</p>
                    </div>
                    <div class="footer-col">
                        <h4>Quick Links</h4>
                        <ul>
                            <li><a href="#" onclick="showScreen('roleSelect')">Login / Sign Up</a></li>
                            <li><a href="#" onclick="showScreen('vendorAuth')">Become a Vendor</a></li>
                            <li><a href="#" onclick="showScreen('adminAuth')">Admin Access</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Contact</h4>
                        <ul>
                            <li>support@festivchain.com</li>
                            <li>+91 98765 43210</li>
                            <li>Kochi, Kerala, India</li>
                        </ul>
                    </div>
                </div>
                <div class="footer-bottom">
                    &copy; 2025 FestivChain. All rights reserved.
                </div>
            </footer>
        </section>

        <!-- Screen: Role Selection (Now accessed via Get Started) -->
        <section id="roleSelect" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('landingPage')">‚Üê Back to Home</div>
                <div class="role-selector">
                    <h2>Choose Your Role</h2>
                    <div class="role-buttons">
                        <button class="btn btn-primary role-btn" onclick="showScreen('customerAuth')">
                            <span class="role-icon">üë§</span>
                            <span class="role-text">I'm a Customer</span>
                        </button>
                        <button class="btn btn-secondary role-btn" onclick="showScreen('vendorAuth')">
                            <span class="role-icon">üè™</span>
                            <span class="role-text">I'm a Vendor</span>
                        </button>
                        <button class="btn btn-tertiary role-btn" onclick="showScreen('adminAuth')">
                            <span class="role-icon">üîë</span>
                            <span class="role-text">Admin</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Screen: Customer Auth -->
        <section id="customerAuth" class="screen">
            <div class="container">
                <div class="auth-card">
                    <div class="back-btn" onclick="showScreen('roleSelect')">‚Üê Back</div>
                    <h2>Customer Login / Sign Up</h2>
                    <form id="custAuthForm">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="custEmail" placeholder="you@example.com" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="custPassword" placeholder="Choose a password" required>
                        </div>
                        <small>New users will be created automatically on first sign-in.</small>
                        <div style="display:flex; gap:8px; margin-top:12px;">
                            <button type="button" class="btn btn-primary btn-full"
                                onclick="handleCustomerSignIn(event)">Sign In</button>
                            <button type="button" class="btn btn-outline btn-full"
                                onclick="handleCustomerSignUp(event)">Sign Up</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Screen: Vendor Auth -->
        <section id="vendorAuth" class="screen">
            <div class="container">
                <div class="auth-card">
                    <div class="back-btn" onclick="showScreen('roleSelect')">‚Üê Back</div>
                    <h2>Vendor Login / Sign Up</h2>
                    <form id="vendAuthForm">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="vendEmail" placeholder="vendor@business.com" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="vendPassword" placeholder="Choose a password" required>
                        </div>
                        <small>New vendor accounts are created on first sign-in. Vendors will get default inventory (20
                            units each) which they can edit.</small>
                        <div style="display:flex; gap:8px; margin-top:12px;">
                            <button type="button" class="btn btn-primary btn-full"
                                onclick="handleVendorSignIn(event)">Sign In</button>
                            <button type="button" class="btn btn-outline btn-full"
                                onclick="handleVendorSignUp(event)">Sign Up</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Screen: Admin Auth -->
        <section id="adminAuth" class="screen">
            <div class="container">
                <div class="auth-card">
                    <div class="back-btn" onclick="showScreen('roleSelect')">‚Üê Back</div>
                    <h2>Admin Login</h2>
                    <form id="adminAuthForm" onsubmit="handleAdminAuth(event)">
                        <div class="form-group">
                            <label>Admin Email</label>
                            <input type="email" id="adminEmail" placeholder="admin@festivchain.local" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="adminPassword" placeholder="Admin password" required>
                        </div>
                        <small>Uses local hardcoded credentials for admin (change in code before production).</small>
                        <div
                            style="margin-top:8px; padding:8px; background:#fff8e1; border-radius:6px; font-size:0.95em;">
                            <strong>Admin hint:</strong> email <code>admin@festivchain.local</code> password
                            <code>Admin@123</code>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Login</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Screen: Admin Dashboard -->
        <section id="adminDashboard" class="screen">
            <div class="container">
                <div class="header-bar">
                    <h2>Admin Dashboard</h2>
                    <button class="btn btn-sm btn-icon" onclick="logout()" title="Logout">üö™</button>
                </div>

                <div class="card">
                    <h3>Database Actions</h3>
                    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:16px;">
                        <button class="btn btn-danger" onclick="clearSampleData()">Clear Categories & Products</button>
                        <button class="btn btn-success" onclick="initializeSeasonalDemo()">Create Seasonal Demo
                            Data</button>
                        <button class="btn btn-secondary" onclick="loadAdminDashboard()">Reload Lists</button>
                    </div>

                    <h3 style="margin-top:20px;">Create Category</h3>
                    <form
                        onsubmit="event.preventDefault(); (async ()=>{ const name=document.getElementById('adminCatName').value; const season=document.getElementById('adminCatSeason').value; const img=document.getElementById('adminCatImg').value; await createCategory({name,season,image:img}); document.getElementById('adminCatName').value=''; loadAdminDashboard(); })()">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Name</label>
                                <input id="adminCatName" required>
                            </div>
                            <div class="form-group">
                                <label>Season</label>
                                <input id="adminCatSeason" placeholder="e.g., Winter">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Image URL</label>
                            <input id="adminCatImg">
                        </div>
                        <button class="btn btn-primary" type="submit">Create Category</button>
                    </form>

                    <h3 style="margin-top:20px;">Create Product</h3>
                    <form onsubmit="handleCreateProduct(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Product Name</label>
                                <input id="adminProdName" required>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <input id="adminProdCat" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Market Price</label>
                                <input id="adminProdMarket" type="number">
                            </div>
                            <div class="form-group">
                                <label>Prices (JSON)</label>
                                <input id="adminProdPrices" placeholder='e.g. {"Winter":200,"Summer":180}'>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Image URL</label>
                                <input id="adminProdImg" placeholder="https://...">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input id="adminProdDesc">
                        </div>
                        <button class="btn btn-primary" type="submit">Create Product</button>
                    </form>

                    <h3 style="margin-top:20px;">Categories</h3>
                    <div id="adminCategoriesList" style="margin-bottom:12px;"></div>

                    <h3 style="margin-top:20px;">Products</h3>
                    <div id="adminProductsList"></div>
                </div>
            </div>
        </section>

        <!-- Screen: Customer Home -->
        <section id="customerHome" class="screen">
            <div class="container">
                <div class="header-bar">
                    <h2 id="custWelcome">Welcome! üëã</h2>
                    <div class="header-actions">
                        <button class="btn btn-sm btn-icon" onclick="showScreen('customerLocation')"
                            title="Change Location">üìç</button>
                        <button class="btn btn-sm btn-icon" onclick="showScreen('customerProfile')"
                            title="Profile">üë§</button>
                        <button class="btn btn-sm btn-icon" onclick="logout()" title="Logout">üö™</button>
                    </div>
                </div>

                <!-- Customer Navbar -->
                <div class="customer-nav">
                    <button class="nav-item" onclick="showScreen('vendorsList')">
                        <span class="nav-icon">üè™</span>
                        <span>Browse Vendors</span>
                    </button>
                    <button class="nav-item" onclick="showScreen('cartScreen')">
                        <span class="nav-icon">üõí</span>
                        <span>My Cart</span>
                    </button>
                    <button class="nav-item" onclick="showScreen('ordersScreen')">
                        <span class="nav-icon">üì¶</span>
                        <span>My Orders</span>
                    </button>
                </div>

                <div id="custLocationInfo" class="location-info"></div>

                <!-- Festival Date Selector -->
                <div class="date-selector">
                    <label>üìÖ Select Delivery Date (Festival Theme Changes):</label>
                    <input type="date" id="festivalDate" onchange="handleDateChange()">
                </div>

                <!-- Categories -->
                <h3>Browse by Category</h3>
                <div class="category-grid" id="categoryGrid"></div>

                <!-- Featured Products -->
                <h3 style="margin-top: 40px;">Featured Products</h3>
                <div class="carousel-wrapper">
                    <div id="featuredProducts" class="carousel-track"></div>
                </div>
            </div>
        </section>

        <!-- Screen: Customer Location Selection -->
        <section id="customerLocation" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <div class="card">
                    <h2>Update Location</h2>
                    <form id="locationForm" onsubmit="updateLocation(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>City</label>
                                <select id="citySelect" onchange="updateAreas()" required>
                                    <option value="">Select City</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Area</label>
                                <select id="areaSelect" required>
                                    <option value="">Select Area</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Save Location</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Screen: Products Browse -->
        <section id="productsScreen" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <h2 id="categoryTitle">Products</h2>
                <div id="productsList" class="product-grid"></div>
            </div>
        </section>

        <!-- Screen: Product Detail -->
        <section id="productDetail" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('productsScreen')">‚Üê Back</div>
                <div class="product-detail-card" id="productDetailContent"></div>
            </div>
        </section>

        <!-- Screen: Pre-Book -->
        <section id="prebookScreen" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('productDetail')">‚Üê Back</div>
                <div class="card">
                    <h2>Pre-Book Product</h2>
                    <div id="prebookContent"></div>
                </div>
            </div>
        </section>

        <!-- Screen: Cart -->
        <section id="cartScreen" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <h2>üõí Shopping Cart</h2>
                <div id="cartContent"></div>
            </div>
        </section>

        <!-- Screen: Orders -->
        <section id="ordersScreen" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <h2>üì¶ My Orders</h2>
                <div id="ordersList"></div>
            </div>
        </section>

        <!-- Screen: Vendors List -->
        <section id="vendorsList" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <h2>üè™ Verified Vendors Near You</h2>
                <div id="vendorsGrid" class="vendor-grid"></div>
            </div>
        </section>

        <!-- Screen: Vendor Dashboard -->
        <section id="vendorDashboard" class="screen">
            <div class="container">
                <div class="header-bar">
                    <h2>Vendor Dashboard</h2>
                    <button class="btn btn-sm btn-icon" onclick="logout()" title="Logout">üö™</button>
                </div>

                <div class="stats-grid" id="vendorStats"></div>

                <div class="vendor-actions">
                    <button class="btn btn-primary" onclick="showScreen('productListing')">üìã Add Product</button>
                    <button class="btn btn-success" onclick="loadVendorOrders(); showScreen('vendorOrders')">‚úÖ
                        Pre-Books</button>
                    <button class="btn btn-info" onclick="loadVendorInventory(); showScreen('vendorInventory')">üìä
                        Inventory</button>
                </div>
            </div>
        </section>

        <!-- Screen: Product Listing -->
        <section id="productListing" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('vendorDashboard')">‚Üê Back</div>
                <div class="card">
                    <h2>üìã Add New Product</h2>
                    <form id="productForm" onsubmit="handleProductListing(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Product Name</label>
                                <input type="text" id="prodName" placeholder="e.g., Fresh Roses" required>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="prodCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="Flowers">Flowers</option>
                                    <option value="Fruits">Fruits</option>
                                    <option value="Sweets">Sweets</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Price per Unit (‚Çπ)</label>
                                <input type="number" id="prodPrice" placeholder="e.g., 340" min="0" step="10" required>
                            </div>
                            <div class="form-group">
                                <label>Stock Available</label>
                                <input type="number" id="prodStock" placeholder="e.g., 50" min="0" step="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Delivery Date</label>
                            <input type="date" id="prodDelivery" required>
                        </div>
                        <button type="submit" class="btn btn-success btn-full">List Product</button>
                    </form>

                    <h3 style="margin-top: 40px;">Your Products</h3>
                    <div id="vendorProductsList"></div>
                </div>
            </div>
        </section>

        <!-- Screen: Vendor Orders -->
        <section id="vendorOrders" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('vendorDashboard')">‚Üê Back</div>
                <h2>‚úÖ Pre-Book Requests</h2>
                <div id="vendorPrebookList"></div>
            </div>
        </section>

        <!-- Screen: Vendor Inventory -->
        <section id="vendorInventory" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('vendorDashboard')">‚Üê Back</div>
                <h2>üìä Inventory Management</h2>
                <div id="vendorInventoryList"></div>
            </div>
        </section>

        <!-- Screen: Customer Profile -->
        <section id="customerProfile" class="screen">
            <div class="container">
                <div class="back-btn" onclick="showScreen('customerHome')">‚Üê Back</div>
                <div class="card">
                    <h2>üë§ My Profile</h2>
                    <div id="profileContent"></div>
                </div>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script src="src/js/utils.js"></script>
    <script src="src/js/themes/themeManager.js"></script>
    <script src="src/js/navbarHelper.js"></script>
    <script src="src/js/firebase/auth.js"></script>
    <script src="src/js/firebase/database.js"></script>
    <script src="src/js/app.js"></script>
</body>

</html>